<html>
<head>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.0/font/bootstrap-icons.min.css">
<script src="https://cdn.jsdelivr.net/npm/sortablejs@1.13.0/Sortable.min.js"></script>
<script>
var maps = ["Bank", "Border", "Chalet", "Clubhouse", "Coastline", "Consulate", "Kafe", "Kanal", "Oregon", "Skyscraper", "Villa", "Theme Park"];
function shuffle(array) {
  var currentIndex = array.length, temporaryValue, randomIndex;

  // While there remain elements to shuffle...
  while (0 !== currentIndex) {

    // Pick a remaining element...
    randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex -= 1;

    // And swap it with the current element.
    temporaryValue = array[currentIndex];
    array[currentIndex] = array[randomIndex];
    array[randomIndex] = temporaryValue;
  }

  return array;
}
function tokenize(name) {
    return name.replace(/\s/g, '').toLowerCase();
}
var val = 100;
function addMapOption(id, name) {
    var formName = "form"+id;
    var label = $("<label></label>").text(name).attr("for", id);
    // var rVal = Math.floor(Math.random() * 200 )-100;
    var rVal = val;
    val -= 200/(maps.length-1);
    var input = $("<input type='range' min='-100' max='100' class='form-control-range' list='ticks' />").attr("id", id).attr("name", name).attr("value", rVal);
    var handle = $("<i class='bi bi-grip-vertical handle'></i>");
    var mapOption = $("<div class='mapOption'></div>").append(handle,label,input);
    $("#maps").append(mapOption);
}

function sortElements() {
    var maps = $(".mapOption");
    maps.sort(function(a, b) {
        return parseInt(a.children[2].value) > parseInt(b.children[2].value) ? -1 : 1;
    }).appendTo("#maps");
}
$( document ).ready(function() {
    shuffle(maps);
    maps.forEach(x => addMapOption(tokenize(x), x))
    // shuffle($(".mapOption")).appendTo("#maps");
    $(".mapOption").mouseup(sortElements);
    Sortable.create(document.getElementById("maps"), {handle: ".handle", dragoverBubble: true, onMove: function(evt) {
        var v =  evt.dragged.children[2].value;
        evt.dragged.children[2].value = evt.related.children[2].value;
        evt.related.children[2].value = v;
    }});
});
</script>
<style>
    .labels {
    display: flex;
    justify-content: space-between;
    }
    .mapOption {
        margin-top: .6rem;
    }
    label {
        margin-bottom: .2rem;
    }
    
    .handle {
        cursor: move;
    }
</style>
</head>
<body>
<div class="container">
    <h1 class="display-1">Siege Map Rankings</h1>
<form
  action="https://formspree.io/f/xyybwjod"
  method="POST"
>
<datalist id="ticks">
    <option>-100</option>
    <option>-50</option>
    <option>0</option>
    <option>50</option>
    <option>100</option>
</datalist>
  <div class="form-group">
    <label for="inputName">Name</label>
    <input class="form-control" name="name" required="true">
  </div>
  <div class="form-group" id="maps">
    <small class="form-text text-muted labels"><span>Strongly Dislike</span><span>Dislike</span><span>Neither like nor dislike</span><span>Like</span><span>Strongly Like</span></small>
  </div>
  <button type="submit" class="btn btn-primary">Send</button>
</form>
</div>
</body>
</html>